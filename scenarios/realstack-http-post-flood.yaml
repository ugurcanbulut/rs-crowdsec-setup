type: leaky
name: realstack/http-post-flood
description: "Detect IPs sending more than 20 POST requests in 1 minute (excludes WordPress API endpoints)"
filter: evt.Parsed.request startsWith "POST" and not (evt.Parsed.http_path contains "/wp-json/v1")
capacity: 20           # threshold
leakspeed: 1m          # over 1 minute
groupby: "evt.Meta.source_ip"
blackhole: 10m         # optional, immediate short ban
labels:
  confidence: 1
  spoofable: 0
  classification:
    - attack.T1499  # DDoS / flooding
  behavior: "http:flood"
  label: "POST flood"
  service: http
  remediation: true
  duration: "4h"