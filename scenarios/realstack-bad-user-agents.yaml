type: leaky
name: realstack/bad-user-agent
description: "Custom list of bad user agents"
filter: |
  evt.Meta.log_type in ["http_access-log", "http_error-log"] &&
  (
    evt.Parsed.http_user_agent == nil ||
    evt.Parsed.http_user_agent == "-" ||
    evt.Parsed.http_user_agent == "" ||
    evt.Parsed.http_user_agent == "Mozilla" ||
    evt.Parsed.http_user_agent == "Mozilla/5.0" ||
    evt.Parsed.http_user_agent == "Mozilla 5.10" ||
    evt.Parsed.http_user_agent matches ".*YandexBot.*" ||
    evt.Parsed.http_user_agent matches ".*Homesnap.*" ||
    evt.Parsed.http_user_agent matches ".*AwarioBot.*"
  )
capacity: 1
leakspeed: 1m
groupby: "evt.Meta.source_ip"
blackhole: 2m
labels:
  confidence: 1
  spoofable: 0
  classification:
    - attack.T1595
  behavior: "http:scan"
  label: "Bad User Agent"
  service: http
  remediation: true